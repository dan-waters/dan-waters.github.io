function g_init(){$(".theme_special").first().addClass("level_2_header");var window_width=$(window).width(),init_device_size=determineDevice(window_width);if(null===el("noGlobal")){if(g_localStorageEnabled){var pcms_id=localStorage.getItem("pcms_id"),mh_url=localStorage.getItem("mh_url");if(pcms_id&&mh_url&&el("myaccount-text")){el("myaccount-text").innerHTML="Reset Customer Basket",hideEl("myaccount-icon"),$("#myaccount-text").addClass("iso_mh_reset"),$("#myaccount-icon").parent().remove();var html='<a href="/logout" id="iso_logout" style="display: inline;"><div class="header-content"><div id="myaccount-text" class="item iso_mh_reset">Sign Out</div></div></a>';$("#customer_login_button").after(html),$(".wishlist").hide(),g_instore_mode=!0}}if(el("level_1_nav")||el("current_checkout_step")){menuResize(init_device_size),window.onresize=function(){menuResize(determineDevice($(window).width()))};var $menu=$("#level_1_nav");$menu.menuAim({activate:activateSubmenu,deactivate:deactivateSubmenu})}else $.ajax({type:"GET",url:"/?mm",success:renderMegaMenu,error:ajaxFailHandler})}videoResize(window_width,!0),$("body").fadeIn(200),$.event.special.swipe.scrollSupressionThreshold=screen.availWidth/60,$.event.special.swipe.horizontalDistanceThreshold=screen.availWidth/5,$.event.special.swipe.verticalDistanceThreshold=screen.availHeight/13,window_width<960&&($("#nearest_store_nav").hide(),$("#loaction_loading").hide()),$(window).resize(function(){var new_window_width=$(window).width();g_customerNearStoreFound?new_window_width>959?($("#nearest_store_nav").show(),$("#location_loading").hide()):($("#nearest_store_nav").hide(),$("#location_loading").hide()):new_window_width>959?($("#nearest_store_nav").hide(),$("#location_loading").show()):($("#nearest_store_nav").hide(),$("#location_loading").hide()),videoResize(new_window_width,!1),resizeSearchSuggestion(),didResize=!0,stickyFooter()}),$(window).on("scroll",closeMegaMenu),$(window).on("resize",closeMegaMenu),$('[data-toggle="popover"]').popover(),$("#login_modal").on("show.bs.modal",onLoginModalShow),backdropHide(),loadPersonal(),stickyFooter(),cookieTermsCheck(),checkAwcCode(),bindNavScroll(),loadComponentCT()}function asyncBackgroundImage(src_element,target_id){switch(setClassCss(elClass("level_2_nav"),css_array={display:"block","background-color":"none"}),determineDevice($(window).width())){case"c1":case"c2":break;case"c3":case"c4":var image_source=src_element.getAttribute("data-backgroundimage"),image_obj=new Image;image_obj.src=image_source,image_obj.onload=function(){el(target_id).style.backgroundImage="url( '"+image_source+"')",el(target_id).style.display="block"}}}function updatePromotionImage(element){el("megamenu-background").style.display="none";var contentlist=element.getAttribute("data-contentlist"),content1=element.getAttribute("data-content1"),content2=element.getAttribute("data-content2");setClassCss(elClass("sbr-menu"),css_array={background:"url('/img/megamenu/2/"+contentlist+"')","background-size":"100% 624px"}),setClassCss(elClass("sbr_content1"),css_array={background:"url('/img/megamenu/2/"+content1+"')","background-size":"100% 624px"}),setClassCss(elClass("sbr_content2"),css_array={background:"url('/img/megamenu/2/"+content2+"')","background-size":"100% 624px"})}function menuResize(device){el("megamenu-background"),$(".navigation-container").width(),$("#megamenu_button").width(),$(".wishlist").width();return $(".sub-menu").hide(),$(".dropdown-menu li").click(function(e){e.stopPropagation()}),flyoutMenu=$(".flyout_menu_container"),menuToggle=$("#megamenu_toggle"),level_1_nav=el("level_1_nav"),mm_wrap=$(".mm_wrap"),menuToggle.on("show.bs.dropdown",function(){$("#megamenu_button").focus(),backDropIn(),closeSearchSuggestions(),lazyLoad(),/iPhone/i.test(navigator.userAgent)&&(g_lastKnownBodyScroll=$(window).scrollTop()),$(".floated_elemental").css("height","508px"),g_level_1_resized=!1,$("#level_1_nav").outerHeight()>$(window).height()-100&&(mm_wrap.css("height",$(window).height()-100+"px"),$(window).scrollTop>160?$(".floated_elemental").css("height",$(window).height()-10+"px"):$(".floated_elemental").css("height",$(window).height()-100+"px"),g_level_1_resized=!0)}),menuToggle.on("hide.bs.dropdown",function(){g_lastKnownBodyScroll=!1,backDropOut(),closeSearchSuggestions(),stopBodyScrolling(!1),mmAssistClick()}),"c1"===device?($("#level_1_nav").width($(window).width()),mm_wrap.width($(window).width()),void $("ul.flyout_menu_container").width($(window).width()-40)):"c2"===device?($("#level_1_nav").css("width",""),$("ul.flyout_menu_container").width($(window).width()-40),void mm_wrap.width($(window).width())):($("ul.flyout_menu_container").width(""),void mm_wrap.width(""))}function videoResize(window_width,initial_load){var video_arr=$(".responsive-video");try{for(var i=0;i<video_arr.length;i++){var video=video_arr[i],data_attr=video.dataset,source=document.createElement("source");source.setAttribute("type","video/mp4");var new_source="",isIE=/MSIE|Trident|Windows Phone/.test(window.navigator.userAgent);isIE?void 0!==data_attr[959]?(new_source=data_attr[959],source.setAttribute("src",new_source)):void 0!==data_attr[599]?(new_source=data_attr[599],source.setAttribute("src",new_source)):void 0!==data_attr[300]&&(new_source=data_attr[300],source.setAttribute("src",new_source)):window_width>=1200?void 0!==data_attr[1199]?(new_source=data_attr[1199],source.setAttribute("src",new_source)):void 0!==data_attr[959]?(new_source=data_attr[959],source.setAttribute("src",new_source)):void 0!==data_attr[599]?(new_source=data_attr[599],source.setAttribute("src",new_source)):void 0!==data_attr[300]&&(new_source=data_attr[300],source.setAttribute("src",new_source)):window_width>=960?void 0!==data_attr[959]?(new_source=data_attr[959],source.setAttribute("src",new_source)):void 0!==data_attr[599]?(new_source=data_attr[599],source.setAttribute("src",new_source)):void 0!==data_attr[300]&&(new_source=data_attr[300],source.setAttribute("src",new_source)):window_width>=600&&void 0!==data_attr[599]?(new_source=data_attr[599],source.setAttribute("src",new_source)):void 0!==data_attr[300]&&(new_source=data_attr[300],source.setAttribute("src",new_source));for(var og_source=!1;video.firstChild;){if(og_source=video.firstChild.getAttribute("src"),og_source===new_source)return;video.removeChild(video.firstChild)}initial_load||video.pause(),video.appendChild(source),initial_load||video.load();var playPromise=video.play();void 0!==playPromise&&playPromise.catch(function(){video.play()})}}catch(e){console.log(e)}}function onNavClick(event,level,element,type){switch($(element).find(".level_2_nav").show(),$(element).find(".sub_menu").show(),determineDevice($(window).width())){case"c1":case"c2":$(".sub-menu").show(),clickedItem=$(element),1==level&&($(level_1_nav).hasClass("child_selected")?($(level_1_nav).removeClass("child_selected"),clickedItem.children(".flyout_menu_container").removeClass("slide"),$(".navbar-fixed-top").removeAttr("style"),$(".floated_elemental").removeClass("slide_side"),$("ul#sub-menu").removeClass("slide")):($(".floated_elemental").addClass("slide_side"),$(level_1_nav).addClass("child_selected"),clickedItem.children(".flyout_menu_container").addClass("slide"),$(".navbar-fixed-top").css({position:"relative",top:$("#navigation_bar").offset().top-100+"px"})));break;case"c3":case"c4":}}function mmAssistClick(event){$(".sub-menu").hide(),void 0!==event&&event.stopPropagation(),$(level_1_nav).removeClass("child_selected"),$(".flyout_menu_container").removeClass("slide"),$(".floated_elemental").removeClass("slide_side"),$(".navbar-fixed-top").removeAttr("style"),$(".mm_wrap").scrollTop(0)}function resetBodyScroll(){return!g_refineModalOpen&&void(g_lastKnownBodyScroll!==!1&&$(window).scrollTop(g_lastKnownBodyScroll))}function setAffixWidth(){$("#floaty").width($("#floaty").width()),$("#floaty").affix({offset:{top:65}}),$(window).resize(function(){$("#floaty").width($("#floaty").width())})}function bindNavScroll(){return g_posMode?(disbableFixedHeader(),!1):(determineFixedHeader(),/iPhone|iPad|iPod/i.test(navigator.userAgent)&&(document.addEventListener("touchmove",determineFixedHeader,!1),document.addEventListener("touchmove",resetBodyScroll,!1)),document.addEventListener("scroll",determineFixedHeader,!1),void document.addEventListener("scroll",resetBodyScroll,!1))}function determineFixedHeader(){return!g_refineModalOpen&&!g_instore_mode&&void($(window).scrollTop()>=160&&1!==$("body#checkout").length?enableFixedHeader():$(window).scrollTop()<159&&disbableFixedHeader())}function mobileUnfixHeader(){$(".masthead_wrap").css("top",$(window).scrollTop()),$(".navbar-fixed-top").css("position","absolute")}function refixHeader(){$(".masthead_wrap").css("top",""),$(".navbar-fixed-top").css("position","")}function enableFixedHeader(){g_headerHasFaded||($("#masthead_wrapper").addClass("nav-fade"),g_headerHasFaded=!0),$(".masthead_wrap").addClass("navbar-fixed-top hf_on hf_s"),$("body").css("padding-top",g_headerHeight+100)}function disbableFixedHeader(){$("#masthead_wrapper").removeClass("nav-fade"),$(".masthead_wrap").removeClass("navbar-fixed-top hf_on hf_s"),$("body").css("padding-top","0px"),$(".navbar-fixed-top ").removeClass("hf_searching"),closeSearchSuggestions(),g_headerHasFaded=!1}function renderImpersonationMenu(data){if(data){order_channel="P";var kube_username=null===data.kube_username?"Unknown":data.kube_username,kube_user_id=null===data.kube_id?"Unknown":data.kube_id;$("#imp_kube_username").html(kube_username),$("#imp_kube_user_id").html(kube_user_id),$("#impersonation_banner").show(),menuResize(determineDevice($(window).width()))}}function fixedSearchClick(){$(".navbar-fixed-top").toggleClass("hf_searching"),$(".search-dropdown").hide(),$(".backdrop-fullscreen").removeClass("in").height(0)}function renderMegaMenu(data){if(null!==el("megamenu_toggle")){el("megamenu_toggle").innerHTML=el("megamenu_toggle").innerHTML+data,$(".theme_special").first().addClass("level_2_header"),menuResize(determineDevice($(window).width())),window.onresize=function(){menuResize(determineDevice($(window).width()))};var menu=$("#level_1_nav");menu.menuAim({activate:activateSubmenu,deactivate:deactivateSubmenu})}}function onLoginModalShow(){el("login_modal_email").focus()}function activateSubmenu(a){var b=$(a),c=b.children("ul");b.children("a").addClass("hover"),"c1"===determineDevice($(window).width())||"c2"===determineDevice($(window).width())?(c.css({display:"block",visibility:"visible"}),$(".sub-menu").show()):c.css({display:"block",visibility:"visible"})}function deactivateSubmenu(a){var b=$(a),c=b.children("ul");b.find("a").removeClass("hover"),"c1"===determineDevice($(window).width())||"c2"===determineDevice($(window).width())?(c.css({display:"none",visibility:"hidden"}),$(".sub-menu").hide()):c.css({display:"none",visibility:"hidden"})}function openLoginModal(url){return void 0===url?(alert("url variable not set"),!1):(el("modal_login_form").action=url,$("#login_modal").modal("show"),void(el("login_modal_email").value.length>3&&(el("modal_login_check_email").disabled=!1)))}function renderBasketCount(data){var anchor_mh=$("#header_basket_anchor_mh"),pill_mh=$("#header_basket_pill_mh"),anchor_affixed=$("#header_basket_anchor_aff"),pill_affixed=$("#header_basket_pill_aff");if(null!==pill_mh&&$(pill_mh).remove(),null!==pill_affixed&&$(pill_affixed).remove(),!(void 0===data||null===data||isNaN(data)||data<1)){count=data;var mh_html=count?anchor_mh.html()+'<div class="header-basket-pill" id="header_basket_pill_mh">':anchor_mh.html()+'<div id="header_basket_pill_mh" class="header-basket-pill pill-empty">',aff_html=count?anchor_affixed.html()+'<div class="header-basket-pill" id="header_basket_pill_aff">':anchor_affixed.html()+'<div id="header_basket_pill_aff" class="header-basket-pill pill-empty">';mh_html+=count+"</div>",aff_html+=count+"</div>",anchor_mh.html(mh_html),anchor_affixed.html(aff_html)}}function updateBasketPillCount(data){return!!g_localStorageEnabled&&(localStorage.setItem("basketItemCount",parseInt(data.count)),void(null==data||parseInt(data.count)<1?$(".header-basket-pill").addClass("pill-empty"):renderBasketCount(data.count)))}function rstoreSearch(){if(g_searchSubmitted)return!1;g_searchSubmitted=!0;var term=sanitizeSearch(el("searchBox").value.toString().trim());if(term=encodeURIComponent(term),0===term.length)return g_searchSubmitted=!1,!1;el("searchTerm").value=term,""===el("searchBoxCat").value&&(el("searchBoxCat").value="false");var searchForm=el("navSearch");return searchForm.action="/search?q="+term,searchForm.submit(),!1}function renderSearchPageSuggestDropdown(json_data){$("#article_search_wrapper").hide();var searchDropdown=$(".search-dropdown"),resultsObj=el("article-results");if(resultsObj.innerHTML="",0!==json_data.responseHeader.status||0===json_data.response.numFound)return void searchDropdown.find(".suggestion").removeClass("js-show");var maxCount=9;maxCount>json_data.response.numFound&&(maxCount=json_data.response.numFound);for(var html="",i=0;i<maxCount;i++){var search_doc=json_data.response.docs[i],doc_id=search_doc.id;search_doc.name=void 0!==json_data.highlighting[doc_id].name?json_data.highlighting[doc_id].name[0]:highlightSearchString(search_doc.name,el("searchBox").value),search_doc.link_description=void 0!==search_doc.link_description?search_doc.link_description:"Article by The Range";var article_entry='<li class="suggestion" title="'+search_doc.link_description+'"><a href="/'+search_doc.page_url+'">',thumbnail_url=search_doc.thumbnail_url;article_entry+=thumbnail_url.length>0?'<img class="product-search-thumbnail" src="'+thumbnail_url+'"> ':'<img class="product-search-thumbnail" src="/img/quill_inkpot.png">',html+=article_entry+search_doc.name+"</a></li>"}resultsObj.innerHTML=html,searchDropdown.find(".suggestion:not(.js-show)").addClass("js-show"),searchDropdown.show(),searchSuggestionResize(),$("#article_search_wrapper").show()}function renderSearchSuggestDropdown(json_data){$("#product_search_wrapper").hide();var searchDropdown=$(".search-dropdown"),resultsObj=el("product-results");if(resultsObj.innerHTML="",0!==json_data.responseHeader.status||0===json_data.response.numFound)return void searchDropdown.find(".suggestion").removeClass("js-show");var maxCount=9;maxCount>json_data.response.numFound&&(maxCount=json_data.response.numFound);for(var html="",i=0;i<maxCount;i++){var search_doc=json_data.response.docs[i],doc_id=search_doc.id;void 0!==json_data.highlighting[doc_id].name?search_doc.name=json_data.highlighting[doc_id].name[0]:search_doc.name=highlightSearchString(search_doc.name,el("searchBox").value),html+='<li class="suggestion" title="Suggested Search Term" onclick="selectSuggestedSearch( this );"><a>'+json_data.response.docs[i].name+"</a></li>"}resultsObj.innerHTML=html,searchDropdown.find(".suggestion:not(.js-show)").addClass("js-show"),searchDropdown.show(),searchSuggestionResize(),$("#product_search_wrapper").show()}function highlightSearchString(haystack,needle){var pattern=new RegExp(needle,"gi"),match=haystack.match(pattern);return haystack.replace(match,'<span class="suggestion-match-highlight">'+match+"</span>")}function renderSearchRelevantDropdown(json_data){$("#relevance_search_wrapper").hide();var searchDropdown=$(".search-dropdown"),resultsObj=el("promotion-results");if(resultsObj.innerHTML="",0!==json_data.responseHeader.status||0===json_data.response.numFound)return void searchDropdown.find(".suggestion").removeClass("js-show");var maxCount=5;maxCount>json_data.response.numFound&&(maxCount=json_data.response.numFound);for(var html="",i=0;i<maxCount;i++){var search_doc=json_data.response.docs[i];search_doc.name=highlightSearchString(search_doc.name,el("searchBox").value),html+='<a href="/'+search_doc.page_url+'"><li title="Matching Products" class="suggestion"><img class="product-search-thumbnail" src="'+search_doc.thumbnail_url+'"> '+search_doc.name+"</li></a>"}resultsObj.innerHTML=html,searchDropdown.find(".suggestion:not(.js-show)").addClass("js-show"),searchDropdown.show(),searchSuggestionResize(),$("#relevance_search_wrapper").show()}function renderSearchDropdown(json_data){renderSearchRelevantDropdown(json_data.select),renderSearchPageSuggestDropdown(json_data.suggest_page_name)}function closeSearchSuggestions(){$(".search-dropdown").hide(),$(".navigation-bar").css("z-index",""),$("body").removeClass("height-wrap"),$(".filter-overlay.mobile-filter.enabled, .filter-overlay.tablet-filter.enabled").removeClass("enabled"),$(".refine-results-confirm").css("display","none")}function toggleProposition(item){$(item).find(".proposition-caret").toggleClass("caret_up"),$(".products_parent, .nationwide_parent").toggleClass("hidden-xs")}function rstoreSuggest(event){if(void 0!==event){var keynum=event.charCode||event.keyCode||0;if(27==keynum)return closeSearchSuggestions(),!1;if(13==keynum)return!1}var term=el("searchBox").value,esc_term=term.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),all_dept_term='<span style="font-weight: bold; display: inline;">'+esc_term.charAt(0).toUpperCase()+esc_term.slice(1)+'</span> in <span style="color: #FA4616; display: inline">All Departments</span>';$("#shop_all_dept_anchor").html(all_dept_term),$("#all_dept_wrapper").show(),$(".backdrop-fullscreen").addClass("in").height($("html").height()),$("#search-suggest-dropdown").show();var searchDropdown=$(".search-dropdown");return term.length<3&&"*"!==term.length?(searchDropdown=$(".search-dropdown"),searchDropdown.hide(),void searchDropdown.find(".suggestion").removeClass("js-show")):($.ajax({type:"POST",url:"/searchsuggest",data:{action:"search",term:term},beforeSend:showLoadingSpinner,success:renderSearchDropdown,error:ajaxFailHandler}),!1)}function onSearchBoxFocus(){searchSuggestion(el("searchBox").value)}function backdropHide(){$(".backdrop-fullscreen").on("click",function(){return closeMegaMenu(),!1}),closeSearchSuggestions()}function closeMegaMenu(){closeSearchSuggestions(),resetMegaMenu(),backDropOut(),g_lastKnownBodyScroll=!1,stopBodyScrolling(!1),$(".floated_elemental").removeClass("slide_side"),$(".navbar-fixed-top").removeClass("hf_searching")}function resetMegaMenu(){$("#megamenu_toggle").removeClass("open"),$("ul.dropdown-navigation li").removeClass("child_selected"),$("ul#sub-menu").removeClass("slide"),$(".floated_elemental").removeClass("slide_side")}function onDidYouMeanClick(searchTerm){el("searchTerm").value=searchTerm;var searchForm=el("navSearch");return searchForm.action=searchForm.action+"?q="+searchTerm,searchForm.submit(),!1}function showLoadingSpinner(){$("#product-results").html('<div class="col-xs-12" style="text-align: center; padding: 20px;"><img src="/img/spinner.gif" style="width: 30px;"/></div>')}function selectSuggestedSearch(element){el("searchBox").value=element.innerHTML,rstoreSearch()}function refreshCountdown(){g_countdown&&0!==--g_countdown||clearInterval(g_countdown_interval);var time=g_countdown,seconds=Math.floor(time%60);time/=60;var minutes=Math.floor(time%60);time/=60;var hours=Math.floor(time%24),days=Math.floor(time/24),day=1==days?"Day":"Days",hour=1==hours?"Hour":"Hours",second=1==seconds?"Second":"Seconds",minute=1==minutes?"Minute":"Minutes";$(".countdownDays").html("<p class='blackFriday-timeLeft'>"+days+"</p><br class='hidden-xs'><span class='blackFriday-timeUnit'>"+day+"</span>"),$(".countdownHours").html("<p class='blackFriday-timeLeft'>"+hours+"</p><br class='hidden-xs'><span class='blackFriday-timeUnit'>"+hour+"</span>"),$(".countdownMinutes").html("<p class='blackFriday-timeLeft'>"+minutes+"</p><br class='hidden-xs'><span class='blackFriday-timeUnit'>"+minute+"</span>"),$(".countdownSeconds").html("<p class='blackFriday-timeLeft'>"+seconds+"</p><br class='hidden-xs'><span class='blackFriday-timeUnit'>"+second+"</span>")}function loadPersonal(){if(!el("noGlobal")){var data={},prod_id=$("#add_to_basket > #selected-product-id").val();if(void 0!==prod_id&&(data.prod_id=prod_id),el("noBasketUpdates")||(data.basket_csv=loadBasketFromLocalStorage()),"/myaccount"===location.pathname&&(data.myaccount=!0),g_localStorageEnabled){var comp_clickthrough=localStorage.getItem("cmp-ct");null!==comp_clickthrough&&comp_clickthrough.length>0&&(data.cmpct=comp_clickthrough),localStorage.removeItem("cmp-ct");var pcms_id=localStorage.getItem("pcms_id"),mh_key=localStorage.getItem("mh_url");pcms_id&&mh_key&&(data.pcms_id=pcms_id,data.mh_key=mh_key)}$.ajax({type:"POST",data:data,url:"/myaccount?me",success:applyPersonalDecor,error:ajaxFailHandler})}}function applyPersonalDecor(data){if(void 0!==data.force_auth&&data.force_auth.length>0)return void window.location.assign("/"+data.force_auth);if(void 0!==data.pos&&void 0!==data.pos.store_name){var html='<div class="">Sign Out (Active Store: '+data.pos.store_name+")</div>";$("#iso_logout #myaccount-text").html(html)}if(g_loggedIn=data.logged_in,void 0!==data.countdown&&(g_countdown=data.countdown,refreshCountdown(),$(".timer").removeClass("hidden"),g_countdown_interval=setInterval(refreshCountdown,1e3)),g_loggedIn&&initCheckInTimer(),void 0!==data.basket_csv&&data.basket_csv&&saveBasketToLocalStorage(data.basket_csv),data.show_collect){hideEl("proposition_lowest_price");var elem=el("proposition_lowest_price_collection");elem&&(elem.style.display="inline")}if("/contact/"===window.location.pathname&&g_loggedIn&&(data.email&&(document.querySelector("#email-address").value=data.email),data.firstname&&(document.querySelector("#first-name").value=data.firstname),data.surname&&(document.querySelector("#last-name").value=data.surname),data.telephone&&(document.querySelector("#telephone").value=data.telephone)),data.mp_opted_in)el("login_interests_mp")&&(el("login_interests_mp").checked=!0),hideEl("newsletter_submit_wrapper"),hideEl("newsletter_success_wrapper");else if(showEl("login_interests_mp_wrapper"),data.email&&el("newsletter_email")&&(el("newsletter_email").value=data.email),data.newsletter_signed_up)hideEl("newsletter_submit_wrapper"),hideEl("newsletter_success_wrapper");else if(g_localStorageEnabled){var ls_newsletter=localStorage.getItem("newsletter_signed_up"),ls_newsletter_ts=localStorage.getItem("newsletter_signed_up_ts"),ts=(new Date).getTime();ls_newsletter?ls_newsletter_ts&&ts-ls_newsletter_ts>864e5?(showEl("newsletter_submit_wrapper"),stickyFooter()):(hideEl("newsletter_submit_wrapper"),hideEl("newsletter_success_wrapper")):(showEl("newsletter_submit_wrapper"),stickyFooter())}else showEl("newsletter_submit_wrapper"),stickyFooter();if(hideEl("customer_account_placeholder"),void 0!==data.impersonation&&renderImpersonationMenu(data.impersonation),void 0!==data.basket_count&&renderBasketCount(data.basket_count),data.location&&applyGeoDecor(data.location),g_instore_mode)return!1;if(!data.logged_in&&el("customer_login_button"))return el("customer_login_button").setAttribute("href","/login"),showEl("customer_login_button"),!1;hideEl("customer_login_button"),g_customerUsername=data.logged_in,showEl("customer_account"),void 0!==data.firstname&&el("customer_account_username")&&(el("customer_account_username").innerHTML="Hello "+data.firstname+"!",showEl("customer_account_username"),showEl("customer_account")),el("wishlist-icon")&&(g_wishlist_count=void 0!=data.wishlist_arr?data.wishlist_arr.length:0,el("wishlist-icon").src=g_wishlist_count>0&&el("wishlist-icon")?"/img/like-heart-selected.png":"/img/masthead/heart.png"),null!=el("welcome_txt")&&(el("welcome_txt").innerHTML="Hi "+data.firstname+",");var amend_nav=el("amendment_nav");if(null!==amend_nav){if(null!==data.kube_user_id&&document.getElementById("product_template")&&void 0!==data.kube_user_id&&data.kube_user_id!==!1?$(amend_nav).html(renderAmendmentNav(data.kube_user_id)).show():amend_nav.innerHTML="",void 0!==data.likes_arr&&data.likes_arr!==!1&&customerLikesArrReload(data.likes_arr),void 0!==data.useful_review_arr&&"object"==typeof data.useful_review_arr&&(useful_review_arr=data.useful_review_arr),void 0!==data.pending_review&&data.pending_review!==!1){var reviewed_list=el("review"),list_content=reviewed_list.innerHTML;reviewed_list.innerHTML=data.pending_review+list_content}if(void 0!==data.product_like&&data.product_like===!0){var save_for_later_anchor=el("save_for_later_anchor");save_for_later_anchor.setAttribute("data-saved","true"),save_for_later_anchor.text="Saved For Later",save_for_later_anchor.style.backgroundColor="#3c7f53",save_for_later_anchor.style.border="2px solid #3c7f53",save_for_later_anchor.style.color="#ffffff"}}}function initCheckInTimer(){setTimeout(sendCheckInRequest,g_check_in_interval)}function sendCheckInRequest(){$.ajax({url:"/myaccount?ci",type:"POST",success:initCheckInTimer,error:ajaxFailHandler})}function renderAmendmentNav(kube_user_id){var html='<a onclick="loadAmendmentForm('+kube_user_id+');"><div class="header-icon"><img src="/img/masthead/amend.png" alt=""></div><div class="header-content sub no_after" style="padding-top: 8px; padding-right: 5px;"><span></span><div class="down-drop"></div><div class="item" style="margin-top: 8px; color: #FA4616;">Request Amendment</div></div></a>';return html}function loadAmendmentForm(kube_user_id){return!document.getElementById("amend_product")&&($.ajax({type:"POST",url:"?amend&kube_user_id="+kube_user_id,success:renderAmendForm,error:ajaxFailHandler}),!1)}function renderAmendForm(data){$("#delivery_proposition_container").after(data)}function requestGeo(use_geo,update_geo_stock,store_finder_submit,resubmit_fulfilment){if($("#gps_crosshair").hide(),$("#gps_loading").show(),g_updateGeoStock=update_geo_stock,g_storeFindersubmit=void 0!=store_finder_submit&&store_finder_submit,g_resubmitFulfilment=void 0!=resubmit_fulfilment&&resubmit_fulfilment,!use_geo)try{if(isLocalGeoStale())return;if(!g_localStorageEnabled)return;var localGeoData={store_id:localStorage.getItem("store_id"),postcode:localStorage.getItem("postcode"),store_name:localStorage.getItem("store_name"),country:localStorage.getItem("country"),open_time:localStorage.getItem("open_time"),close_time:localStorage.getItem("close_time"),distance:localStorage.getItem("distance"),short_postcode:localStorage.getItem("short_postcode"),page_url:localStorage.getItem("store_url")};return void(void 0!=localGeoData.store_name&&applyGeoDecor(localGeoData))}catch(e){return}return navigator.geolocation?(navigator.geolocation.getCurrentPosition(onGeoObtained,onGpsFailure,{timeout:gps_timeout}),g_gpsGeoObtained):(onGpsFailure(),!1)}function onGpsFailure(){setTimeout(function(){$("#gps_crosshair, #gps_failure_notice").show(),$("#gps_loading").hide()},1e3),g_gpsGeoObtained=!1}function onGeoObtained(geodata){if(g_gpsGeoObtained=!0,null===geodata)return applyGeoDecor("");var latitude=null,longitude=null,postcode=null;void 0===geodata.coords&&(postcode=geodata),void 0!==geodata.coords&&(latitude=geodata.coords.latitude,longitude=geodata.coords.longitude);var data={latitude:latitude,longitude:longitude,postcode:postcode};return $.ajax({type:"POST",url:"/stores/?geo",data:data,success:applyGeoDecor,error:ajaxFailHandler}),!0}function applyGeoDecor(data){if(0===data.length||!data.store_name)return void requestManualGeolocation();if(g_posMode)return!1;var near_store_details=data.store_name;if(void 0!=data.distance&&data.distance!==!1){var distance_text=1==data.distance?"Mile":"Miles";near_store_details+=" ("+data.distance+" "+distance_text+")"}if("Closed"!==data.open_time)var near_store_hours="Open Today: "+data.open_time+" - "+data.close_time;else var near_store_hours="Closed Today";var searchInput=el("ml-searchboxinput");el("store_href")&&(el("store_href").href="/"+data.page_url,el("near_store_details").innerHTML=near_store_details,el("near_store_hours").innerHTML=near_store_hours),null!==searchInput&&(searchInput.value=data.postcode),$(window).width()>959?($("#nearest_store_nav").show(),$("#location_loading").hide()):($("#nearest_store_nav").hide(),$("#location_loading").hide()),g_customerNearStoreFound=!0;try{if(g_localStorageEnabled&&(isLocalGeoStale()||data.manual_update)){var stale_time=new Date;stale_time.setMinutes(stale_time.getMinutes()+10),localStorage.setItem("geo_stale",stale_time),localStorage.setItem("id",data.id),localStorage.setItem("postcode",data.postcode),localStorage.setItem("store_name",data.store_name),localStorage.setItem("country",data.country),localStorage.setItem("open_time",data.open_time),localStorage.setItem("close_time",data.close_time),localStorage.setItem("distance",data.distance),localStorage.setItem("short_postcode",data.short_postcode),localStorage.setItem("store_url",data.page_url)}}catch(e){}if(g_updateGeoStock){var data={country:data.country,location:data.postcode};g_geoCalled=!0,$.ajax({type:"POST",url:"/stores/?setlocale",data:data,success:refreshProductAjaxData,error:ajaxFailHandler}),g_updateGeoStock=!1}return g_storeFindersubmit&&($("#gps_crosshair").show(),$("#gps_loading").hide(),$("#store-btn").click()),g_resubmitFulfilment&&$.ajax({type:"POST",url:"?action=resetfulfilment",success:reloadFulfilment,error:ajaxFailHandler}),!0}function isLocalGeoStale(){try{if(!g_localStorageEnabled)return!1;var expiry_time=new Date(localStorage.getItem("geo_stale")),current_time=new Date;return current_time>expiry_time}catch(e){return requestManualGeolocation(),!1}}function requestManualGeolocation(){$(window).width()>959&&$("#location_loading").show(),$("#nearest_store_nav").hide()}function checkLocManualGeodata(){if(!g_localStorageEnabled)return!1;var localGeoData=localStorage.getItem("geo_postcode");return 1===localGeoData}function offerProductClick(target,offerContainer){var product=target.parentNode,productData=product.getAttribute("data-id");$(".site-overlay").css("display","block"),$(".container.primary-product-container.overlay").css("display","none"),$('.container.primary-product-container.overlay[data-id="'+productData+'"]').css("display","block"),$(".package-offers .product-grid .product a img.product-image").css("opacity","0.2"),$(product).find("img").css("opacity","1"),$("html, body").animate({scrollTop:offerContainer.offsetTop},500)}function offerProductClose(target,click_anywhere){var offerOverlayContainer=$(".container.primary-product-container.overlay");click_anywhere===!1||offerOverlayContainer.is(":visible")&&!offerOverlayContainer.is(target)&&offerOverlayContainer.has(target).length||($(".product-container-four.package-offers").css("display","none"),$(".product-container-four.package-offers .product-grid li.product .details").css("display","block"),$(".package-offers .product-grid .product a img.product-image").css("opacity","1"))}function initProductSlider(){exists($(".slider-might-also-like"))&&($(".slider-goes-well-with").slick({lazyLoad:"ondemand",speed:300,slidesToShow:3,slidesToScroll:2,arrows:!0,infinite:!0,prevArrow:'<button type="button" data-role="none" class="slick-prev-prod verticalAlign" aria-label="previous">Previous</button>',nextArrow:'<button type="button" data-role="none" class="slick-next-prod verticalAlign" aria-label="next">Next</button>',responsive:[{breakpoint:4e3,settings:{slidesToShow:3,lazyLoad:"ondemand",slidesToScroll:2}},{breakpoint:960,settings:{lazyLoad:"ondemand",slidesToShow:2,slidesToScroll:1}},{breakpoint:600,settings:{slidesToShow:1,slidesToScroll:1}}]}),$(".slider-might-also-like").slick({lazyLoad:"ondemand",speed:300,slidesToShow:3,slidesToScroll:2,arrows:!0,prevArrow:'<button type="button" data-role="none" class="slick-prev-prod verticalAlign" aria-label="previous">Previous</button>',nextArrow:'<button type="button" data-role="none" class="slick-next-prod verticalAlign" aria-label="next">Next</button>',infinite:!0,responsive:[{breakpoint:4e3,settings:{slidesToShow:3,lazyLoad:"ondemand",slidesToScroll:2}},{breakpoint:960,settings:{lazyLoad:"ondemand",slidesToShow:2,slidesToScroll:1}},{breakpoint:600,settings:{slidesToShow:1,slidesToScroll:1}}]}),exists($(".slider-saved-for-later"))&&($(".slider-saved-for-later").slick({lazyLoad:"ondemand",speed:300,slidesToShow:4,slidesToScroll:4,arrows:!0,prevArrow:'<button type="button" data-role="none" class="slick-prev-prod verticalAlign" aria-label="previous">Previous</button>',nextArrow:'<button type="button" data-role="none" class="slick-next-prod verticalAlign" aria-label="next">Next</button>',infinite:!0,responsive:[{breakpoint:3500,settings:{slidesToShow:4,lazyLoad:"ondemand",slidesToScroll:2}},{breakpoint:1200,settings:{slidesToShow:3,lazyLoad:"ondemand",slidesToScroll:2}},{breakpoint:960,settings:{lazyLoad:"ondemand",slidesToShow:2,slidesToScroll:1}},{breakpoint:600,settings:{slidesToShow:1,slidesToScroll:1}}]}),exists($(".slider-customers-who-bought"))&&($(".slider-customers-who-bought").slick({lazyLoad:"ondemand",speed:300,slidesToShow:4,slidesToScroll:4,arrows:!0,prevArrow:'<button type="button" data-role="none" class="slick-prev-prod verticalAlign" aria-label="previous">Previous</button>',nextArrow:'<button type="button" data-role="none" class="slick-next-prod verticalAlign" aria-label="next">Next</button>',infinite:!0,responsive:[{breakpoint:3500,settings:{slidesToShow:4,lazyLoad:"ondemand",slidesToScroll:2}},{breakpoint:1200,settings:{slidesToShow:3,lazyLoad:"ondemand",slidesToScroll:2}},{breakpoint:960,settings:{lazyLoad:"ondemand",slidesToShow:2,slidesToScroll:1}},{breakpoint:600,settings:{slidesToShow:1,slidesToScroll:1}}]}),exists($(".slider-bundle"))&&$(".slider-bundle").slick({lazyLoad:"ondemand",speed:300,slidesToShow:3,slidesToScroll:2,arrows:!0,prevArrow:'<button type="button" data-role="none" class="slick-prev-prod verticalAlign" aria-label="previous">Previous</button>',nextArrow:'<button type="button" data-role="none" class="slick-next-prod verticalAlign" aria-label="next">Next</button>',infinite:!0,initialSlide:0,responsive:[{breakpoint:4e3,settings:{slidesToShow:3,lazyLoad:"ondemand",slidesToScroll:2}},{breakpoint:960,settings:{lazyLoad:"ondemand",slidesToShow:2,slidesToScroll:1}},{breakpoint:600,settings:{slidesToShow:1,slidesToScroll:1}}]}))))}function increaseQuantity(target){var fieldName=target.getAttribute("field"),field=document.querySelector("input[name="+fieldName+"]"),currentVal=parseInt(field.value);if(isNaN(currentVal))return void(field.value=1);field.value=currentVal+1;var max_stock=parseInt(target.parentNode.getElementsByClassName("variant-stock")[0].value);max_stock<1&&(max_stock=1),field.value>=max_stock&&(field.value=max_stock)}function decreaseQuantity(target){var fieldName=target.getAttribute("field"),field=document.querySelector("input[name="+fieldName+"]"),currentVal=parseInt(field.value);return!isNaN(currentVal)&&currentVal>1?void(field.value=currentVal-1):void(field.value=1)}function increaseQuantityLeaflet(target){var fieldName=target.getAttribute("field"),field=document.querySelector(".leaflet-tag.active input[name="+fieldName+"]"),currentVal=parseInt(field.value);if(isNaN(currentVal))return void(field.value=1);field.value=currentVal+1;var max_stock=parseInt(target.parentNode.getElementsByClassName("variant-stock")[0].value);max_stock<1&&(max_stock=1),field.value>=max_stock&&(field.value=max_stock)}function decreaseQuantityLeaflet(target){var fieldName=target.getAttribute("field"),field=document.querySelector(".leaflet-tag.active input[name="+fieldName+"]"),currentVal=parseInt(field.value);return!isNaN(currentVal)&&currentVal>1?void(field.value=currentVal-1):void(field.value=1)}function validateQuantity(event){var keynum=event.charCode||event.keyCode||0;if(8===keynum||46===keynum)return!1;var target=event.target;if(isNaN(target.value)||target.value<1)return target.value=1,!0;var max_stock=parseInt(target.parentNode.getElementsByClassName("variant-stock")[0].value);return max_stock<1&&(max_stock=1),target.value>=max_stock?(target.value=max_stock,!0):(target.value=parseInt(target.value,10),!0)}function elClass(target_class){return document.getElementsByClassName(target_class)}function setCss(element,key,value){element.style[key]=value}function setClassCss(elements,css_array){for(var i=0;i<elements.length;i++)for(var key in css_array)setCss(elements[i],key,css_array[key])}function isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints}function determineDevice(screen_width){return screen_width||(screen_width=$(window).width()),screen_width<=599?RSPN.MOBILE:screen_width<=959?RSPN.TABLET:screen_width<=1199?RSPN.DESKTOP:RSPN.EXTENDED}function addEvent(obj,evt,fn){return obj.addEventListener?void obj.addEventListener(evt,fn,!1):void(obj.attachEvent&&obj.attachEvent("on"+evt,fn))}function getQueryParamByName(name,url){url||(url=window.location.href),name=name.replace(/[\[\]]/g,"\\$&");var regex=new RegExp("[?&]"+name+"(=([^&#]*)|&|#|$)"),results=regex.exec(url);return!!results&&(!!results[2]&&decodeURIComponent(results[2].replace(/\+/g," ")))}function calcSearchOffset(){switch(determineDevice()){case"c1":return 0;case"c2":return-6;case"c3":return-5;case"c4":return-5}}function searchSuggestionResize(){return!1}function stickyFooter(){var footer=$("footer");if(footer.length>0){var footer_height=footer.height();$("body").css("margin-bottom",footer_height+20+"px"),footer.show()}didResize=!1}function togglePartedItems(target){var target=$(target),item_ul=target.parent().parent(),productElements=item_ul.find(".product-horizontal");return productElements.hasClass("part-item-list-hide")?(target.html('Hide Items <span class="caret-up"></span>'),productElements.removeClass("part-item-list-hide"),void productElements.show()):(target.html('Show Items <span class="caret"></span>'),productElements.addClass("part-item-list-hide"),void productElements.hide())}function equaliseFooterColumn(){$(".footer_eq_height")&&("c1"==determineDevice()?$(".footer_eq_height").css("height",""):equaliseHeightsNow(".footer_eq_height"))}function equaliseSliderHeight(sliderId){sliderId.find(".slide_container.content").each(function(){var slider=$(this),targetHeight=$(".slide_container.image").height(),imageHeight=slider.find("img").height(),titleHeight=slider.find("h4").height()+25,availableTextHeight=targetHeight-(titleHeight+imageHeight)-24;slider.find("p").dotdotdot({ellipsis:"... ",height:availableTextHeight})})}function equaliseContentHeight(contentId){contentId.find(".content-item").each(function(){var contentContainer=$(this);contentContainer.find("img").height();contentContainer.find("p").dotdotdot({ellipsis:"... ",height:75})})}function cookieTermsCheck(){return!!g_localStorageEnabled&&void("1"!==localStorage.getItem("cookie_terms_accepted")&&el("cookie_terms")&&(el("cookie_terms").style.display="block"))}function cookieTermsAccept(){return!!g_localStorageEnabled&&(localStorage.setItem("cookie_terms_accepted",1),void(el("cookie_terms").style.display="none"))}function customerLikesArrReload(likes_arr){return!(!g_localStorageEnabled||likes_arr.constructor!==Array)&&void localStorage.setItem("likes_arr",JSON.stringify(likes_arr))}function showWishlist(){if(g_customerUsername===!1)return void $("#login_modal").modal("show")}function checkAccountEmailExists(email_element){var email=email_element.value,re=/\S+@\S+\.\S+/;return!re.test(email)||email.length<=3?(email_element.classList.add("invalid_form_field"),!1):(email_element.classList.remove("invalid_form_field"),email_element.classList.add("valid_form_field"),data={action:"check_email_exists",email:email},g_modalLoginEmail=email,void $.ajax({type:"POST",url:"/myaccount?wishlist=a",data:data,success:onEmailExistsSuccess,error:ajaxFailHandler}))}function onEmailExistsSuccess(data){return data.email_exists?(hideEl("modal_login_check_email"),showEl("modal_password_group"),$("#login_modal_password").focus(),!1):(el("modal_login_form_step").value="email",el("modal_login_form_email").value=g_modalLoginEmail,void el("modal_login_form").submit())}function modalLoginSubmit(){return data.email_exists?(hideEl("modal_login_check_email"),showEl("modal_password_group"),!1):(el("modal_login_form_step").value="welcomeback",el("modal_login_form_email").value=g_modalLoginEmail,el("modal_login_form_password").value=el("login_modal_password").value,void el("modal_login_form").submit())}function ieLog(message){var body=$("body"),body_content=body.html();message='<pre style="padding: 50px; color: black;"><strong>IE Log: </strong></br></br>'+message+"</pre>",body.html(message+body_content)}function ieArrLog(array){for(var i=0;i<array.length;i++){var item=array[i];message+=item+"</br>"}ieLog(message)}function exists(element){return!!element&&(void 0!==element&&null!==element)}function setAttr(element,attr,value){element.setAttribute(attr,value)}function getAttr(element,attr){return element.getAttribute("data-"+attr)}function addClass(element,className){$(element).addClass(className)}function removeClass(element,className){$(element).removeClass(className)}function toggleClass(element,className){$(element).toggleClass(className)}function disableElement(element){element.disabled=!0}function enableElement(element){element.disabled=!1}function containsClass(yourObj,yourClass){return!(!yourObj||"string"!=typeof yourClass)&&!!(yourObj.className&&yourObj.className.trim().split(/\s+/gi).indexOf(yourClass)>-1)}function checkAwcCode(){if(g_localStorageEnabled){var awc_pos=window.location.href.indexOf("awc=");if(awc_pos!=-1){awc_pos+=4;var href=window.location.href,key_end=href.indexOf("&",awc_pos),awc_code=key_end!=-1?href.substring(awc_pos,key_end):href.substring(awc_pos);if(awc_code.length>0){var awc_exp=Math.round((new Date).getTime()/1e3+2592e3);localStorage.setItem("awc",awc_code),localStorage.setItem("awc_exp",awc_exp)}}var awc_code=localStorage.getItem("awc");if(null!=awc_code){var time_now=Math.round((new Date).getTime()/1e3),awc_exp=localStorage.getItem("awc_exp");if(awc_exp>=time_now){var awc_exp=Math.round((new Date).getTime()/1e3+2592e3);localStorage.setItem("awc_exp",awc_exp),window.therangeaffiliate=awc_code}}}}function checkNavOffset(){if(0===$(".masthead_wrap").length)return!1;var doc_top=$(document).scrollTop(),masthead_top=$(".masthead_wrap").offset().top;doc_top<masthead_top&&$(".navbar-fixed-top").removeAttr("style")}function removeLoadingOverlay(){$("#checkout_loading_overlay").removeClass("is-visible")}function addLoadingOverlay(info){void 0!==info?$("#checkout_loading_info").html(info):$("#checkout_loading_info").html("One moment, loading your account data..."),$("#checkout_loading_overlay").addClass("is-visible")}function parseQueryString(){var parsed_parameters={};uri_parameters=location.search.substr(1).split("&");for(var i=0;i<uri_parameters.length;i++){var parameter=uri_parameters[i].split("=");parsed_parameters[parameter[0]]=decodeURIComponent(parameter[1])}return parsed_parameters}function sendGA(step,action,options){var ga_test=!1;if(void 0===step)return console.log("Unknown GA Step."),!0;if(void 0===step)return console.log("Unknown GA "+step+" Option."),!0;void 0!==options&&options!==!1||(options=void 0);var step_number=!1;switch(step){case"basket":switch(step_number=1,action){case"load":break;case"edit":break;case"delete":break;case!1:break;default:return console.log("Unknown GA "+step+" Action."),!0}break;case"email":switch(step_number=2,action){case"error":break;case"change":break;case"confirm":break;case"login":break;case"register":break;case"continue":break;case"complete":break;case"forgot":break;case"verification":break;case!1:break;default:return console.log("Unknown GA "+step+" Action."),!0}break;case"delivery":switch(step_number=3,action){case"error":break;case"change":break;case"select":break;case"add":break;case"cancel":break;case"lookup":break;case"manual":break;case"international":break;case!1:break;default:return console.log("Unknown GA "+step+" Action."),!0}break;case"fulfilment":switch(step_number=4,action){case"error":break;case"change":break;case"example":break;case"confirm":break;case!1:break;default:return console.log("Unknown GA "+step+" Action."),!0}break;case"billing":switch(step_number=5,action){case"error":break;case"change":break;case"select":break;case"add":break;case"cancel":break;case"lookup":break;case"manual":break;case"international":break;case!1:break;default:return console.log("Unknown GA "+step+" Action."),!0}break;case"payment":switch(step_number=6,action){case"error":break;case"change":break;case"select":break;case"add":break;case"confirm":break;case!1:break;default:return console.log("Unknown GA "+step+" Action."),!0}break;case"details":step_number=7,options=void 0;break;case"placeorder":switch(action){case"paypal":break;case"smartpay":break;case"pos":break;case!1:break;default:return console.log("Unknown GA "+step+" Action."),!0}break;case"confirmation":switch(step_number=8,action){case"continue":break;case!1:break;default:return console.log("Unknown GA "+step+" Action."),!0}break;default:return console.log("Unknown GA Step."),!0}return ga_last_step=ga_step!==!1?ga_step:"none",ga_last_action=ga_action!==!1?ga_action:"none",8==step_number?ga_test?(console.log("Fake GA Send",step_number),console.log("Purchase",ga_options),!1):(window.order_reference=ga_options.id,window.order_subtotal=ga_options.revenue-ga_options.shipping,window.order_finalpayment=ga_options.revenue,window.order_vouchercode="",dataLayer.push({event:"checkout",ecommerce:{purchase:{actionField:{affiliation:ga_options.affiliation,id:ga_options.id,revenue:ga_options.revenue,tax:ga_options.tax,shipping:ga_options.shipping,platform:ga_options.platform},products:ga_options.products}}}),!0):ga_test?(console.log("Fake GA Send",step_number),!1):(dataLayer.push({event:"checkout",ecommerce:{checkout:{actionField:{step:step_number,options:options}}}}),!0)}function fireGAEvent(virtualPageCategory,virtualPageEvent,virtualPageAction,virtualPageURL,virtualPageTitle){virtualPageEvent&&dataLayer.push({event:"virtualPageView",virtualPageCategory:virtualPageCategory,virtualPageEvent:virtualPageEvent,virtualPageAction:virtualPageAction,virtualPageURL:virtualPageURL,virtualPageTitle:virtualPageTitle})}function resetPOSCustomerSession(){$.ajax({type:"POST",url:"/pos?ajax&a=resetPosCustomer",success:onPosCustomerResetComplete,error:ajaxFailHandler})}function onPosCustomerResetComplete(data){200===data.status&&window.location.assign("/")}function stopBodyScrolling(bool){return!1}function submitNewsletterSignup(){var email=el("newsletter_email");if(!checkFormValidity(el("newsletter_signup_form")))return!1;var data={newsletter:"signup",email:email.value};return $.ajax({type:"POST",url:"/myaccount",data:data,success:onSubmitNewsletterSignupComplete,error:ajaxFailHandler}),!1}function onSubmitNewsletterSignupComplete(data){if(g_localStorageEnabled){localStorage.setItem("newsletter_signed_up","true");var ts=(new Date).getTime();localStorage.setItem("newsletter_signed_up_ts",ts)}showEl("newsletter_success_wrapper"),hideEl("newsletter_submit_wrapper")}function loadBasketFromLocalStorage(){if(!g_localStorageEnabled)return!1;var basket_csv=localStorage.getItem("Local-Basket");return(!basket_csv||basket_csv.length>0)&&basket_csv}function saveBasketToLocalStorage(basket_csv){return!!g_localStorageEnabled&&(basket_csv&&0!==basket_csv.length?(localStorage.setItem("Local-Basket",basket_csv),!0):(localStorage.removeItem("Local-Basket"),!0))}function localStorageTest(){try{localStorage.setItem(test,test);var test=localStorage.getItem(test);return localStorage.removeItem(test),!0}catch(exception){return!1}return localStorage}function loadComponentCT(){var preview=el("preview_mode");if(!preview)return!1;var url=window.location.search;url=url.replace("?","");for(var param_arr=url.split("&"),version=!1,page_id=!1,i=0;i<param_arr.length;i++){var param_value_arr=param_arr[i].split("=");"pid"===param_value_arr[0]&&(page_id=param_value_arr[1]),"ver"===param_value_arr[0]&&(version=param_value_arr[1])}version!==!1&&page_id!==!1||(version=el("prev_page_version").value,page_id=el("prev_page_id").value);var data={page_id:page_id,version:version};$.ajax({type:"POST",url:"/myaccount?cct",data:data,success:loadComponentCTComplete,error:ajaxFailHandler})}function loadComponentCTComplete(data){if(void 0===data.success||!data.success)return!1;$(".cms_click_counter").remove();var max_count=0,total_count=0;for(var component in data.ct_arr)for(var index in data.ct_arr[component]){var count=data.ct_arr[component][index].click_count,sale=data.ct_arr[component][index].sale_amount/100,spc=data.ct_arr[component][index].sale_per_click/100;total_count+=count,count>max_count&&(max_count=count);var html='<div class="cms_click_counter" style="position: absolute; top: 10px; left: 20px; z-index: 9999; background-color: #FFF; border: 1px solid #000; text-align: center; padding: 10px;">'+count+" (£"+sale+" / £"+spc+" per click)</div>";$(".cms_"+component+"_"+index).prepend(html).css("position","relative")}if(el("preview_ct_header"))return!0;var html='<div id="preview_ct_header" class="row" style="text-align: right; padding-top: 20px; padding-right: 20px;"><div class="col-xs-12"><button class="btn btn-success" id="cms_ct_enabled" style="display: none; margin-right: 10px;" onclick="return componentCTToggleOff();">CT Tracking Enabled</button><button class="btn btn-danger" id="cms_ct_disabled" style="display: none; margin-right: 10px;" onclick="return componentCTToggleOn();">CT Tracking Disabled</button><button class="btn btn-success" id="cms_rt_enabled" style="display: none;" onclick="return componentRTToggleOff();">Real Time Updates Enabled</button><button class="btn btn-danger" id="cms_rt_disabled" style="display: none;" onclick="return componentRTToggleOn();">Real Time Updates Disabled</button></div></div>';$("body").prepend(html),$("#cms_rt_disabled, #cms_ct_enabled").show()}function percentageColour(value){var hue=(120*(1-value)).toString(10);return["hsl(",hue,",100%,50%)"].join("")}function componentCTToggleOff(){return $("#cms_ct_enabled, .cms_click_counter").hide(),$("#cms_ct_disabled").show(),!1}function componentCTToggleOn(){return $("#cms_ct_enabled, .cms_click_counter").show(),$("#cms_ct_disabled").hide(),!1}function componentRTToggleOn(){return $("#cms_rt_enabled").show(),$("#cms_rt_disabled").hide(),g_refresh_ct_timer=setInterval(loadComponentCT,g_clickthrough_interval),!1}function componentRTToggleOff(){return $("#cms_rt_disabled").show(),$("#cms_rt_enabled").hide(),clearInterval(g_refresh_ct_timer),g_refresh_ct_timer=!1,!1}function registerCompCT(element,component,index){if(!g_localStorageEnabled)return!1;void 0===index&&(index=0);var comp_click_item={current_path:window.location.pathname,component:component,index:index};localStorage.setItem("cmp-ct",JSON.stringify(comp_click_item))}function isTouching(funcName){var userWidth=window.screen.width;/iPhone|iPad|iPod|(android)/i.test(navigator.userAgent)&&userWidth<=600&&(window.addEventListener("scroll",funcName),window.addEventListener("touchmove",funcName))}function isScrolledIntoView(elem){var $elem=$(elem),$window=$(window),docViewTop=$window.scrollTop(),docViewBottom=docViewTop+$window.height(),elemTop=$elem.offset().top,elemBottom=elemTop+$elem.height();return elemBottom<=docViewBottom+5}function eventDebounce(func,wait){var timeout;return function(){var context=this,args=arguments,later=function(){timeout=null,func.apply(context,args)};clearTimeout(timeout),timeout=setTimeout(later,wait)}}function geoTeardownComponent(){el("geo_input_error_msg")&&(el("geo_input_error_msg").innerHTML="Please enter a valid postcode"),hideEl("geo_input_error_wrapper"),hideEl("geo_country_wrapper"),showEl("geo_curr_loc_wrapper"),$("#geo_curr_loc_icon").removeClass("geo_curr_loc_icon_rotate"),$(".leaflet-tag.active #geo_curr_loc_icon").removeClass("geo_curr_loc_icon_rotate"),$(".leaflet-tag.active #geo_input_wrapper").hide(),$("#geo_input_wrapper").hide(),$("#geo_product_wrapper").show(),$(".leaflet-tag.active #geo_product_wrapper").show(),el("geo_input_location").value="",$("#geo_input_btn").removeClass("geo_submit_spinner disabled").html("Update"),$(".leaflet-tag.active #geo_input_btn").removeClass("geo_submit_spinner disabled").html("Update"),$(".geo_use_gps_wrapper").show()}function geoToggleLocationInput(element){var is_collapsed=1==element.dataset.collapsed;element.dataset.collapsed=is_collapsed?0:1,$("#geo_curr_loc_icon").toggleClass("geo_curr_loc_icon_rotate"),showEl("geo_postcode_wrapper");var location=el("geo_curr_loc").innerHTML,regex=/\d/;regex.test(location)?$("#geo_curr_loc_country").html("the UK"):(hideEl("geo_postcode_wrapper"),$("#geo_curr_loc_country").html(location)),$("#geo_input_wrapper").slideToggle(200)}function geoToggleLeafletLocationInput(element){var is_collapsed=1==element.dataset.collapsed;element.dataset.collapsed=is_collapsed?0:1,$(".leaflet-tag.active #geo_curr_loc_icon").toggleClass("geo_curr_loc_icon_rotate"),$(".leaflet-tag.active #geo_postcode_wrapper").show();var location=$(".leaflet-tag.active #geo_curr_loc").html(),regex=/\d/;regex.test(location)?$(".leaflet-tag.active #geo_curr_loc_country").html("the UK"):($(".leaflet-tag.active #geo_postcode_wrapper").hide(),$(".leaflet-tag.active #geo_curr_loc_country").html(location)),$(".leaflet-tag.active #geo_input_wrapper").slideToggle(200)}function geoSubmitLocation(element){var location=el("geo_input_location").value;return location.length<3?(geoSubmitLocationError(),!1):void geoLocationUpdate(location,"GB")}function geoSubmitLeafletLocation(element){var location=$(".leaflet-tag.active #geo_input_location").val();return location.length<3?(geoSubmitLocationError(),!1):void geoLocationUpdate(location,"GB")}function geoSubmitLocationError(msg){return geoTeardownComponent(),g_no_geo_error?(g_no_geo_error=!1,g_cust_latitude=!1,g_cust_longitude=!1,geoLocationUpdate(!1,!1),!1):($("#geo_input_wrapper").show(),msg||(msg="Please enter a valid postcode"),el("geo_input_error_msg").innerHTML=msg,showEl("geo_input_error_wrapper"),showEl("geo_input_error_msg"),void removeLoadingOverlay())}function geoLocationUpdate(postcode,country){if((postcode||country)&&(g_cust_latitude=!1,g_cust_longitude=!1),$("#geo_country_panel").hide(),!g_cust_latitude&&!g_cust_longitude&&("GB"!==country&&(postcode=!1),"GB"===country&&postcode===!1))return geoTeardownComponent(),geoToggleLocationInput(el("geo_curr_wrapper")),el("geo_input_location").focus(),$("#geo_curr_loc_country").html("the UK"),showEl("geo_postcode_wrapper"),!1;if(g_cust_latitude&&g_cust_longitude)var data={lat:g_cust_latitude,lng:g_cust_longitude};else if(country!==!1&&"GB"!==country||!postcode)if(country&&!postcode)var data={country:country};else var data={};else var data={country:"GB",postcode:postcode};$("#geo_input_btn").addClass("geo_submit_spinner disabled").html('<img src="/img/spinner.gif" style="height: 20px; width: 20px;" />'),$("#geo_product_wrapper").hide(),$(".leaflet-tag.active #geo_input_btn").addClass("geo_submit_spinner disabled").html('<img src="/img/spinner.gif" style="height: 20px; width: 20px;" />'),$(".leaflet-tag.active #geo_product_wrapper").hide();var callback=!!el("geo_callback")&&el("geo_callback").value;switch(callback){case"product":data.product_cb=0===el("selected-variant-id").value.length?el("selected-product-id").value:el("selected-product-id").value+"_"+el("selected-variant-id").value;break;case"leaflet":var v=$(".leaflet-tag.active .selected-variant-class"),p=v.closest(".add-to-basket").find(".selected-product-class").val(),vhasVal=v.val(),vHasValueL=v.val().length;data.product_cb=0===vHasValueL?p:p+"_"+vhasVal;break;case"basket":if(postcode===!1&&country===!1)addLoadingOverlay("Loading your basket...");else{var display=postcode!==!1?postcode:country;addLoadingOverlay("Updating your location to "+display.toUpperCase())}data.basket_cb=!0;break;case"checkout":if(g_co_fulfilment_collection)return postcode?loadCollectionFulfilment(postcode):loadCollectionFulfilment(),el("geo_curr_loc")&&postcode&&(el("geo_curr_loc").innerHTML=postcode.toUpperCase()),void geoTeardownComponent();data.checkout_cb=!0}$.ajax({type:"POST",url:"/geo?me",data:data,success:function(data){determineCallback(postcode,country,data),onGeoLocationUpdateComplete(data)},error:ajaxFailHandler})}function determineCallback(postcode,country,data){if(data.success===!1)return geoSubmitLocationError(),!1;data.show_collect&&(hideEl("proposition_lowest_price"),el("proposition_lowest_price_collection").style.display="inline");var callback=!!el("geo_callback")&&el("geo_callback").value;switch(callback){case"product":geoProductUpdate(data.callback.product);break;case"leaflet":geoLeafletUpdate(data.callback.product);break;case"basket":reloadBasket(data.callback.basket);break;case"checkout":changeFulfilment()}}function resetGeoHeader(){return!!el("store_href")&&(el("store_href").href="/stores/",el("near_store_details").innerHTML="",el("near_store_hours").innerHTML="",showEl("location_loading"),hideEl("nearest_store_nav"),void(g_customerNearStoreFound=!1))}function geoHeaderUpdate(store){if(!store)return!1;var near_store_details=store.store_name;if(void 0!=store.distance&&store.distance!==!1){var distance_text=1==store.distance?"Mile":"Miles";near_store_details+=" ("+store.distance+" "+distance_text+")"}if("Closed"!==store.open_time)var near_store_hours="Open Today: "+store.open_time+" - "+store.close_time;else var near_store_hours="Closed Today";var searchInput=el("ml-searchboxinput");el("store_href")&&(el("store_href").href="/"+store.page_url,el("near_store_details").innerHTML=near_store_details,el("near_store_hours").innerHTML=near_store_hours),null!==searchInput&&(searchInput.value=store.postcode),$(window).width()>959?($("#nearest_store_nav").show(),$("#location_loading").hide()):($("#nearest_store_nav").hide(),$("#location_loading").hide()),g_customerNearStoreFound=!0}function onGeoLocationUpdateComplete(data){data.store===!1?resetGeoHeader():geoHeaderUpdate(data.store),$("#geo_curr_loc")&&void 0!==data.location&&$("#geo_curr_loc").html(data.location.display),$(".leaflet-tag.active #geo_curr_loc")&&void 0!==data.location&&$(".leaflet-tag.active #geo_curr_loc").html(data.location.display);var html="";for(var i in data.country.country_arr)html+=geoRenderCountry(data.country.country_arr[i]);$("#geo_country_panel").html(html),$(".leaflet-tag.active #geo_country_panel").text(html),void 0===data.country.can_ship_abroad||data.country.can_ship_abroad?$("#geo_shipping_notice").hide():$("#geo_shipping_notice").show(),geoTeardownComponent()}function geoRenderCollectStores(store_arr){for(var html="",i=0;i<store_arr.length;i++){var store=store_arr[i],title_class=store.active?"":"collect_unavail",title='<span class="'+title_class+'">'+store.name+' <span class="store_miles" style="font-weight: normal">('+store.distance+" miles)</span></span>",text=store.active?'<span class="co_ful_collect_stores_list_info_date green">Available</span>':'<span class="orange collect_unavail">Coming soon</span>';html+='<div class="col-xs-12 store-avail-row no-padding margin-bottom-md"><div class="col-xs-6 no-padding">'+title+'</div><div class="col-xs-6 no-padding" style="text-align: right;">'+text+"</div></div>"}el("store_avail_container").innerHTML=html,$(".leaflet-tag.active #store_avail_container").html(html)}function geoRenderCountry(country){return country.disabled?'<div class="row geo_loc_country" data-cc="'+country.country_code+'"><div class="col-xs-12 geo_country_row"><img class="geo_country_flag bg-'+country.country_code+'_flag" src="/img/img_trans.gif" /><span class="primary_colour geo_country_name" style="text-decoration: line-through;">'+country.name+"</span></div></div>":'<div class="row geo_loc_country" data-cc="'+country.country_code+'" onclick="return geoLocationUpdate( false, \''+country.country_code+'\' );"><div class="col-xs-12 geo_country_row"><img class="geo_country_flag bg-'+country.country_code+'_flag" src="/img/img_trans.gif" /><span class="primary_colour geo_country_name">'+country.name+"</span></div></div>"}function geoRenderCountrySelection(){geoTeardownComponent(),$("#geo_input_wrapper, #geo_curr_loc_wrapper").hide(),$("#geo_country_panel").show(),$("#geo_country_wrapper").show()}function geoLeafletRenderCountrySelection(){geoTeardownComponent(),$(".leaflet-tag.active #geo_input_wrapper, .leaflet-tag.active #geo_curr_loc_wrapper").hide(),$(".leaflet-tag.active #geo_country_panel").show(),$(".leaflet-tag.active #geo_country_wrapper").show()}function awaitEnter(event,target){var keynum=event.charCode||event.keyCode||0;13===keynum&&document.getElementById(target).click()}function attemptGPS(){return g_cust_latitude=!1,g_cust_longitude=!1,g_localStorageEnabled&&!localStorage.getItem("requestedGPS")&&navigator.geolocation?(g_no_geo_error=!0,void loadGPS()):(geoLocationUpdate(!1,!1),!1)}function loadGPS(){if(!navigator.geolocation||!g_localStorageEnabled)return geoLocationUpdate(!1,!1),!1;localStorage.setItem("requestedGPS",1),$(".geo_use_gps_wrapper").hide();try{navigator.geolocation.getCurrentPosition(currentPosSuccess(location),geoLocationUpdate(!1,!1))}catch(e){geoLocationUpdate(!1,!1)}}function currentPosSuccess(location){g_cust_latitude=location.coords.latitude,g_cust_longitude=location.coords.longitude,geoLocationUpdate(!1,!1)}function forceGPS(){return g_localStorageEnabled&&localStorage.removeItem("requestedGPS"),loadGPS(),!1}function showMoreStores(element){var is_collapsed=1==element.dataset.collapsed;element.dataset.collapsed=is_collapsed?0:1;var updateText=is_collapsed?"Hide other stores":"Show other stores";document.querySelector("#geo_prod_showmore").textContent=updateText;var storesContainer=document.querySelector("#store_avail_container");is_collapsed?storesContainer.style.height="130px":storesContainer.style.height="0px"}function showMoreStoresLeaflet(element){var is_collapsed=1==element.dataset.collapsed;element.dataset.collapsed=is_collapsed?0:1;var updateText=is_collapsed?"Hide other stores":"Show other stores";$(".leaflet-tag.active #geo_prod_showmore").text(updateText);var storesContainer=document.querySelector(".leaflet-tag.active #store_avail_container");is_collapsed?storesContainer.style.height="130px":storesContainer.style.height="0px"}function toggleWhatsThis(open){var overlay=document.querySelector(".fullpage_overlay");return open?(document.querySelector(".mto_wt_wrapper").style.width="500px",overlay.style.width="100%",overlay.style.backgroundColor="rgba(0, 0, 0, 0.5)",void(document.body.style.overflowY="hidden")):(document.querySelector(".mto_wt_wrapper").style.width="0px",overlay.style.width="0",overlay.style.backgroundColor="rgba(0, 0, 0, 0)",void(document.body.style.overflowY="scroll"))}function backDropIn(){$("#search_overlay").show(),showSearchSuggestion()}function backDropOut(){$("#search_overlay").hide(),hideSearchSuggestion()}function showSearchSuggestion(){$("#search_sugg_wrapper").fadeIn(200)}function hideSearchSuggestion(){$("#search_sugg_wrapper").hide()}function searchSuggestion(event){if(clearTimeout(g_search_suggestion_time),void 0!==event){var keynum=event.charCode||event.keyCode||0;if(27==keynum)return closeSearchSuggestions(),hideSearchSuggestion(),backDropOut(),!1;if(13==keynum)return!1}var term=sanitizeSearch(el("searchBox").value.toString());return term=encodeURIComponent(term),el("searchBox").dataset.search_term=term,0===term.length?void searchSuggestionLoad():void(g_search_suggestion_time=setTimeout(searchSuggestionLoad,100))}function searchSuggestionLoad(){resizeSearchSuggestion(),backDropIn();var term=el("searchBox").dataset.search_term;return term.length<1?(el("search_sugg_wrapper").innerHTML="",!1):($.ajax({type:"GET",data:{term:term},url:"/search?suggest",success:renderSearchSuggestion,error:ajaxFailHandler}),!1)}function resizeSearchSuggestion(){$("#search_sugg_wrapper").css("width",$("#searchBox").width()+$("#search_go_btn").width()+48)}function renderSearchSuggestion(data){if(void 0===data.status||200!==data.status||!data.sugg_arr)return!1;for(var html="",autocomplete_arr=[],i=0;i<data.sugg_arr.length;i++){var suggestion=data.sugg_arr[i];switch(suggestion.title=decodeURIComponent(suggestion.title),suggestion.type){case"all":html+=renderAllDeptSuggestion(suggestion);break;case"offer":html+=renderOfferSuggestion(suggestion);break;case"product":html+=renderProductSuggestion(suggestion);break;case"phrase":html+=renderPhraseSuggestion(suggestion);break;case"category":html+=renderCategorySuggestion(suggestion);break;case"editorial":html+=renderEditorialSuggestion(suggestion);break;case"autocomplete":autocomplete_arr.push(suggestion)}}autocomplete_arr.length>0&&(html=renderAutocompleteSuggestion(autocomplete_arr)+html),el("search_sugg_wrapper").innerHTML=html}function renderPhraseSuggestion(suggestion){var html="<div class=\"row search_suggestion_row\" onclick=\"suggestionClick( 'phrase', '"+suggestion.title+'\' );"><div class="col-xs-12"><span class="suggestion-title">Search for <strong>'+suggestion.title+"</strong></span></div></div>";return html}function renderProductSuggestion(suggestion){var html="<div class=\"row search_suggestion_row\" onclick=\"suggestionClick( 'product', '"+suggestion.sku+'\' );"><div class="col-xs-12"><span class="suggestion-title"><img style="height: 30px; width: 30px; margin-right: 10px;" src="'+suggestion.media+'" />'+suggestion.title+"</span></div></div>";return html}function renderEditorialSuggestion(suggestion){var html='<div class="row search_suggestion_row search_suggestion_editorial"><div class="col-xs-12"><a style="color: #323232" href="/'+suggestion.url+'" class="search_suggestion_anchor"><img style="height: 20px; width: 20px; margin-right: 10px;" src="/img/quill_inkpot.png" />'+suggestion.title+"</span></div></div>";return html}function renderCategorySuggestion(suggestion){var html="<div class=\"row search_suggestion_row\" onclick=\"suggestionClick( 'category', '"+el("searchBox").value+"', '"+suggestion.cat+'\' );"><div class="col-xs-12"><span class="suggestion-title">Search for <strong>'+suggestion.title+'</strong> in <strong style="color: #FA4616">'+suggestion.cat+"</strong></span></div></div>";return html}function renderAllDeptSuggestion(suggestion){var html="<div class=\"row search_suggestion_row\" onclick=\"suggestionClick( 'all', '"+el("searchBox").value+'\', false );"><div class="col-xs-12"><span class="suggestion-title">Search for <strong>'+suggestion.title+'</strong> in <strong style="color: #FA4616">'+suggestion.cat+"</strong></span></div></div>";return html}function renderOfferSuggestion(suggestion){var html="<div class=\"row search_suggestion_row\" onclick=\"suggestionClick( 'all', '"+el("searchBox").value+'\', \'offer\' );"><div class="col-xs-12"><span class="suggestion-title">Search for <strong>'+suggestion.title+'</strong> in <strong style="color: #D21B26">Offers</strong></span></div></div>';return html}function renderAutocompleteSuggestion(suggestion_arr){for(var html='<div class="col-xs-12 margin-top-md margin-bottom-md" style="padding-left: 25px; padding-right: 25px;"><div class="row">',i=0;i<suggestion_arr.length;i++)html+="<div class=\"search_autocomplete_box\" onclick=\"el('searchBox').value = '"+suggestion_arr[i].title+"'; el('searchBox').click();\">"+suggestion_arr[i].title+"</div>";return html+="</div></div>"}function suggestionClick(type,term,category){el("searchBoxCat").value=void 0!==category?category:"false",el("searchBox").value=term,rstoreSearch()}function loadStoreSuggestions(event,element){var suggest_arr=$(".js_store_suggest");if(13==event.keyCode&&(event.preventDefault(),suggest_arr.length>0)){if(g_selected_suggestion!==!1){var item=suggest_arr[g_selected_suggestion];return item.click(),g_suggestion_used=!0,!1}return confirmStoreSearch(),!1}if(40==event.keyCode&&suggest_arr.length>0){if(g_selected_suggestion===!1){var item=suggest_arr[0];g_selected_suggestion=0}else if(void 0!==suggest_arr[g_selected_suggestion+1]){var item=suggest_arr[g_selected_suggestion+1];g_selected_suggestion++}else{var item=suggest_arr[0];g_selected_suggestion=0}return $(".js_store_suggest").removeClass("selected_suggestion"),$(item).addClass("selected_suggestion"),!1}if(38==event.keyCode&&suggest_arr.length>0){if(g_selected_suggestion===!1){var item=suggest_arr[0];g_selected_suggestion=0}else if(void 0!==suggest_arr[g_selected_suggestion-1]){var item=suggest_arr[g_selected_suggestion-1];g_selected_suggestion--}else{var item=suggest_arr[suggest_arr.length-1];g_selected_suggestion=suggest_arr.length-1}return $(".js_store_suggest").removeClass("selected_suggestion"),$(item).addClass("selected_suggestion"),!1}var search_term=element.value;if(hideEl("location_suggestions"),search_term.length<3)return!0;var data={submit:1,search_term:search_term};$.ajax({type:"POST",url:"/storefeedback/?store_suggest",data:data,success:onLoadStoreSuggestionsComplete,error:ajaxFailHandler})}function onLoadStoreSuggestionsComplete(data){if(0===data.length)return void(el("location_suggestions").innerHTML="");for(var suggestions_html="",x=0;x<data.length;x++){var pos_top=0===x?34:34+32*x,store=data[x];suggestions_html+='<div class="col-xs-12 search_suggestion js_store_suggest" style="top: '+pos_top+'px;" onclick="return selectStore(\''+store.id+"', '"+store.name+"')\">"+store.name+"</div>"}el("location_suggestions").innerHTML=suggestions_html,showEl("location_suggestions"),g_selected_suggestion=!1}function selectStore(store_id,store_name){el("sfb_selected_store_id").value=store_id,el("sfb_selected_store_name").innerHTML=store_name,showEl("sfb_selected_store_wrapper"),hideEl("sfb_select_store_wrapper")}function onChangeSelectedStore(){el("sfb_selected_store_name").innerHTML="",hideEl("sfb_selected_store_wrapper"),showEl("sfb_select_store_wrapper"),el("location_suggestions").innerHTML="",el("feedback_store_search").value=""}function confirmStoreSearch(ele){var search_term=ele?ele.value:el("feedback_store_search").value;if(search_term.length<4)return!1;var data={submit:1,search_term:search_term};return $.ajax({type:"POST",url:"/storefeedback/?store_search",data:data,success:onStoreSearchComplete,error:ajaxFailHandler}),!1}function onStoreSearchComplete(data){return void 0!==data.status&&200!==data.status?(showEl("sfb_store_search_error"),!1):(hideEl("sfb_store_search_error"),void selectStore(data.id,data.name))}function sanitizeSearch(term){return term.replace(/([<>!#+%\\;//"])|([-]){2,}/gi,"")}function klarnaCalculate(){var klarna_value=parseFloat(el("klarna-value").value),no_klarna=el("no-klarna"),klarna_pay_three=el("klarna-pay-in-three"),per_month=el("per-month"),slice_klarna_total=document.getElementsByClassName("slice-klarna-value"),slice_year=el("per-month-year"),slice_year_two=el("per-month-two-year"),slice_year_three=el("per-month-three-year");if(isNaN(klarna_value)||klarna_value<75)return clearWhiteKlarna(),hideSliceYear(),addClass(".three-payback-information, .klarna-slice-it","hidden"),removeClass(".pay-option, #no-klarna, #klarna-slice-options","hidden"),void no_klarna.classList.add("klarna-calculator-white");var pay_three_calc=klarna_value/3;for(i=0;i<slice_klarna_total.length;i++)slice_klarna_total.item(i).innerHTML=klarna_value.toFixed(2);if(klarna_value>=75&&klarna_value<=250){if(clearWhiteKlarna(),klarna_pay_three.classList.add("klarna-calculator-white"),per_month.innerHTML=pay_three_calc.toFixed(2),250!=klarna_value)return hideSliceYear(),removeClass(".three-payback-information, .pay-option, #klarna-slice-options, #no-klarna","hidden"),void addClass(".klarna-slice-it","hidden");showSliceYear(),removeClass(".klarna-slice-it , .three-payback-information","hidden")}var interest_rate=g_klarna_interest/100,slice_year_calc=klarna_value/12,slice_year_two_calc=calculateKlarnaInterest(interest_rate,klarna_value,24),slice_year_three_calc=calculateKlarnaInterest(interest_rate,klarna_value,36);addClass("#klarna-slice-options, #no-klarna","hidden"),klarna_value>250&&(clearWhiteKlarna(),addClass(".three-payback-information","hidden"),showSliceYear(),removeClass(".klarna-slice-it","hidden")),slice_year.innerHTML=slice_year_calc.toFixed(2),slice_year_two.innerHTML=slice_year_two_calc.toFixed(2),slice_year_three.innerHTML=slice_year_three_calc.toFixed(2)}function hideSliceYear(){$("#klarna-slice-one-year, #klarna-slice-two-year, #klarna-slice-three-year").addClass("hidden")}function showSliceYear(){$("#klarna-slice-one-year, #klarna-slice-two-year, #klarna-slice-three-year").removeClass("hidden").addClass("klarna-calculator-white")}function clearWhiteKlarna(){$("div.klarna-calculator-white").removeClass("klarna-calculator-white")}function calculateKlarnaInterest(interest_rate,klarna_value,month){return interest_rate/12*klarna_value/(1-Math.pow(1+interest_rate/12,-month))}function closeKlarnaCalulator(){$(".klarna-financing-container, #klarna-product-calculator").hide()}function openSideBarKlarnaCalculator(){klarnaCalculate(),$("#klarna-product-calculator").show(),$(".klarna-financing-container").toggle("slide"),$(window).scrollTop(0)}var RSPN=RSPN||{};RSPN.MOBILE="c1",RSPN.TABLET="c2",RSPN.DESKTOP="c3",RSPN.EXTENDED="c4",$(document).ready(g_init);var g_localStorageEnabled=localStorageTest(),didResize=!1,g_isTouchDevice=isTouchDevice(),g_gpsGeoObtained=!1,gps_timeout=3e3,g_check_in_interval=3e5,g_clickthrough_interval=1e4,g_refresh_ct_timer=!1,g_customerUsername=!1,g_geoCalled=!1,g_customerNearStoreFound=!1,g_storeFindersubmit=!1,g_loggedIn=!1,g_customerFirstname="",g_customerLastname="",g_customerContactNumber="",g_wishlist_count=0,g_cust_latitude=!1,g_cust_longitude=!1,g_no_geo_error=!1,g_force_geo=!1,level_1_nav=!1,g_level_1_resized=!1,g_level_2_resized=!1,flyoutMenu=!1,menuToggle=!1,g_megamenuActive=!1,g_lastKnownBodyScroll=!1,g_refineModalOpen=!1,g_scrollResize=!0,g_lastDocTop=0,g_updateGeoStock=!1,order_channel="W",g_resubmitFulfilment=!1,g_instore_mode=!1,ga_step=!1,ga_action=!1,ga_options=!1,g_lastGaSent=!1,g_gaProductArr=[],g_posMode=!1,g_headerHasFaded=!1,g_headerHeight=$("#masthead_wrapper").height(),g_searchSubmitted=!1,g_search_suggestion_time,g_countdown=!1,g_countdown_interval=!1;$(window).on("scroll",function(){"c1"==determineDevice()&&$("#megamenu_button").on("click",function(){$(".navbar-fixed-top")&&mobileUnfixHeader()})}),setInterval(function(){didResize&&(stickyFooter(),equaliseFooterColumn(),setAffixWidth())},250),$(document).scroll(function(){checkNavOffset()});var freezeVp=function(e){};